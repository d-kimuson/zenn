---
title: "commitizen ã§ãƒãƒ¼ãƒ ã®è¦ç´„ã‚’ä½œã£ã¦å¯¾è©±å‹ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹ã¨è‰¯ã„æ„Ÿã˜"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: true
---

å¯¾è©±å½¢å¼ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚Œã‚‹ commitizen ã§ç‹¬è‡ªã®è¦ç´„ã‚’è¨­å®šã™ã‚‹ã®ãŒè‰¯ã„æ„Ÿã˜ã ã£ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ï¼

## commitizen is ä½•

[GitHub - commitizen/cz-cli: The commitizen command line utility. #BlackLivesMatter](https://github.com/commitizen/cz-cli)

commitizen ã¯å¯¾è©±å½¢å¼ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

`feat`/`fix`/`doc`...etc ç­‰ã®äºˆã‚æ±ºã‚ã‚‰ã‚ŒãŸãƒ©ãƒ™ãƒ«ã€ã‚¹ã‚³ãƒ¼ãƒ—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ã€ã®æµã‚Œã§é¸æŠã—ã¦è¡Œãã“ã¨ã§

```text
feat(frontend): implement search feature!
```

ã“ã‚“ãªæ„Ÿã˜ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è¦ç´„é€šã‚Šã«ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã†ã®ã«ä¾¿åˆ©ã§ã€commitlint ç­‰ã§è¦ç´„ã«æ²¿ã‚ãªã„ã‚‚ã®ã‚’å¼¾ãã®ã‚‚ã‚¢ãƒªã§ã™ãŒã€å€‹äººçš„ã«ã¯è‡ªå‹•çš„ã«è¦ç´„ã«å‰‡ã£ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒä¿®æ­£ã™ã‚‹æ‰‹é–“ãŒç™ºç”Ÿã—ãªã„ã®ã§è‰¯ã„ã‹ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚[^1]

[^1]: GUI ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹å ´åˆã«ã¯å¯¾å¿œã§ããªã„ã®ã§ã€ãã†ã„ã†ã‚±ãƒ¼ã‚¹ã§ã‚‚è¦ç´„ã‚’å®ˆã‚‰ã›ãŸã„ã®ã§ã‚ã‚Œã° commitlint (ã¾ãŸã¯ä½µç”¨)ã®ã»ã†ãŒé©ã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

## ã¾ãšã¯ cz ã§ç›´æ¥å®Ÿè¡Œã™ã‚‹

```bash
$ pnpm i -D commitizen cz-conventional-changelog
```

ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚commitizen ãŒ cli ã®ãƒ„ãƒ¼ãƒ«ã§ cz-conentional-changelog ã«ã¯ conventional-changelog ã®è¦ç´„ã®è¨­å®šãŒå…¥ã£ã¦ã„ã¾ã™ã€‚

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚‰ commitizen ã§ä½¿ç”¨ã™ã‚‹è¦ç´„ã‚’æ•™ãˆã¦ä¸Šã’ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ package.json ã« config ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```json:pakage.json
{
  // ...
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog"
    }
  }
}
```

ã‚ã¨ã¯ `pnpm cz` ã§å¯¾è©±ãŒå§‹ã¾ã‚‹ã®ã§ç­”ãˆã¦ã„ãã“ã¨ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
$ pnpm cz
cz-cli@4.3.0, cz-custom-rule@1.0.0

? Select the type of change that you're committing: feat:     A new feature
? What is the scope of this change (e.g. component or file name): (press enter to skip) sample
? Write a short, imperative tense description of the change (max 86 chars):
 (15) add new feature
? Provide a longer description of the change: (press enter to skip)

? Are there any breaking changes? No
? Does this change affect any open issues? No

[main 90fb7ad] feat(sample): add new feature
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 tmp
```

ã“ã‚“ãªæ„Ÿã˜ã§ã™ã­ã€‚ã‚³ãƒŸãƒƒãƒˆã¾ã§ä½œæˆã•ã‚Œã¾ã™ã€‚

## ç‹¬è‡ªã®è¦ç´„ã‚’ä½œã‚‹

ã•ã¦ã€conventional-changelog ã‚‚è¦ç´„ã¨ã—ã¦è‰¯ã„ã¨æ€ã„ã¾ã™ãŒã“ã‚Œã¯å…ƒã€… OSS ã¨ã‹ã§ CHANGELOG ã‚’è‡ªå‹•ç”Ÿæˆã—ãŸã‚Šã€SemVer é‹ç”¨ã®æ–‡è„ˆãŒå¼·ã„ã¨æ€ã£ã¦ãŠã‚Šã€ä¸€èˆ¬çš„ãª Web é–‹ç™ºã®è¦ç´„ã¨ã—ã¦ã¯é©ã—ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚

ã®ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦ç‹¬è‡ªã®è¦ç´„ã‚’ä½œã‚Š commitizen ã§ã‚³ãƒŸãƒƒãƒˆã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ãã¾ã™ã€‚

ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã§ã‚ã‚Œã°å°‚ç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¦ãã“ã«è¨­å®šã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚

```bash
# packages/cz-custom-rule
$ pnpm add cz-conventional-changelog
```

```json:package.json
{
  "name": "cz-custom-rule",
  "description": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”¨ã®commitizenã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«",
  "private": true,
  "version": "0.0.1",
  "main": "index.cjs",
  "dependencies": {
    "cz-conventional-changelog": "^3.3.0"
  }
}
```

index.cjs ã«è¨­å®šã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
ä»Šå›ã¯ä»®ã§ã‚·ãƒ³ãƒ—ãƒ«ã«æ–°æ©Ÿèƒ½ãƒ»ä»•æ§˜å¤‰æ›´ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã® 3 ã¤ã®ãƒ©ãƒ™ãƒªãƒ³ã‚°ãŒã§ãã‚‹è¦ç´„ã‚’ç”¨æ„ã—ã¦ã¿ã¾ã™ã€‚

```js:index.cjs
// @ts-check
const engine = require('cz-conventional-changelog/engine')

/** @typedef {{ title: string, description: string, emoji?: string } } CommitType */

// ref: https://github.com/pvdlg/conventional-commit-types/blob/master/index.js#L93
/** @type {{ [K: string]: CommitType }} */
const commitTypes = {
  æ©Ÿèƒ½è¿½åŠ : {
    description: 'æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã¨ãã«ä½¿ã„ã¾ã—ã‚‡ã†ï¼',
    title: 'æ©Ÿèƒ½è¿½åŠ ',
    emoji: 'âœ¨',
  },
  ä»•æ§˜å¤‰æ›´: {
    description: 'æ—¢å­˜ã®æ©Ÿèƒ½ã®ä½¿ç”¨ã‚’å¤‰æ›´ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆã«ä½¿ã„ã¾ã™ï¼',
    title: 'ä»•æ§˜å¤‰æ›´',
    emoji: 'ğŸ“š',
  },
  ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: {
    description: 'ä»•æ§˜ã«å¤‰æ›´ãŒå…¥ã‚‰ãªã„çŠ¶æ…‹ã§ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã™ã‚‹ã¨ãã«ä½¿ã„ã¾ã™ï¼',
    title: 'ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°',
    emoji: 'ğŸ“¦',
  },
}

module.exports = engine({
  types: commitTypes,
  // config ã“ã®è¾ºã®è¨­å®šã‚‚ã‚ˆã—ãªã«
  defaultType: undefined,
  defaultScope: undefined,
  defaultSubject: undefined,
  defaultBody: undefined,
  defaultIssues: undefined,
  disableScopeLowerCase: undefined,
  disableSubjectLowerCase: undefined,
  maxHeaderWidth: 100,
  maxLineWidth: 100,
})
```

ã“ã‚Œã§ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

ã‚ã¨ã¯ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã® package.json ã«ä¾å­˜ã‚’è¿½åŠ ã—ã¦ã€commitizen ã® path è¨­å®šã‚’å‘ã‘ã¦ã‚ã’ã¾ã™ã€‚

```json:pakcage.json
{
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-custom-rule"
    }
  },
  "devDependencies": {
    "cz-custom-rule": "workspace:*"
  }
}
```

ã“ã‚Œã§ç‹¬è‡ªã®è¦ç´„ã§å¯¾è©±çš„ã«ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼

```bash
$ pnpm cz
? Select the type of change that you're committing: (Use arrow keys)
â¯ æ©Ÿèƒ½è¿½åŠ :     æ–°ã—ã„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã¨ãã«ä½¿ã„ã¾ã—ã‚‡ã†ï¼
  ä»•æ§˜å¤‰æ›´:     æ—¢å­˜ã®æ©Ÿèƒ½ã®ä½¿ç”¨ã‚’å¤‰æ›´ã™ã‚‹ã‚³ãƒŸãƒƒãƒˆã«ä½¿ã„ã¾ã™ï¼
  ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: ä»•æ§˜ã«å¤‰æ›´ãŒå…¥ã‚‰ãªã„çŠ¶æ…‹ã§ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã™ã‚‹ã¨ãã«ä½¿ã„ã¾ã™ï¼
```

ä»Šå›ã¯ pnpm workspace ã®ãƒ¢ãƒãƒ¬ãƒæ§‹æˆãŒå‰æã§èª¬æ˜ã—ã¾ã—ãŸãŒã€ä»–ã® workspace ã§ã‚‚åŒæ§˜ã§ã™ã—ã€ãƒ¢ãƒãƒ¬ãƒã§ãªãã¦ã‚‚è¨­å®šç”¨ã® index.cjs ã‚’ç”¨æ„ã—ã¦ç›´æ¥å‚ç…§ã•ã›ã¦ã‚ã’ã‚Œã°å•é¡Œãªãå‹•ãã¯ãšã§ã™ã€‚

## ãƒ•ãƒƒã‚¯ã§å®Ÿè¡Œã™ã‚‹

`pnpm cz` ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸãŒã€ã“ã®ã‚„ã‚Šæ–¹ã¯ husky ç­‰ã§è¡Œã† lint-staged ç³»ã®ä»•çµ„ã¿(ã¤ã¾ã‚Šã‚³ãƒŸãƒƒãƒˆå‰ã« linter ã‚’é€šã™)ã¨ã®ç›¸æ€§ãŒè‰¯ããªã„ã§ã™ã€‚

å…·ä½“çš„ã«ã¯ã€æœ€åˆã«å¯¾è©±ãŒèµ°ã£ã¦ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è€ƒãˆã¦ã‹ã‚‰ linter ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€linter ã§å•é¡ŒãŒè¦‹ã¤ã‹ã£ã¦ã—ã¾ã†ã¨å¯¾è©±ã§å…¥åŠ›ã—ãŸã‚³ãƒŸãƒƒãƒˆã®èª¬æ˜ãŒå…¥åŠ›ã—ç›´ã—ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã™ã€‚

ã§ã™ã®ã§ã€ã“ã‚Œç³»ã®ä»•çµ„ã¿ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯ prepare-commit-msg ã«ãƒ•ãƒƒã‚¯ã¨ã—ã¦å·®ã—è¾¼ã‚“ã§ã‚ã’ã‚‹ã®ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«

```bash:prepare-commit-msg
#!/usr/bin/env sh

exec < /dev/tty && node_modules/.bin/cz --hook || true
```

ã“ã†ã„ã†ãƒ•ãƒƒã‚¯ã‚’ prepare-commit-msg ã«å…¥ã‚Œã¦ã‚ã’ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Š

```bash
$ git commit
```

ã™ã‚‹ã¨ git hooks ãŒç™ºç«ã—ã¦ lint-staged ç­‰ã§ãƒªãƒ³ã‚¿ãƒ¼ã‚’å›ã—ã¦ã‹ã‚‰æˆåŠŸã—ãŸã‚‰å¯¾è©±ãŒå§‹ã¾ã‚‹ã€ã¨ã„ã†å½¢ã‚’å®Ÿç¾ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã®æµã‚Œã§ã‚ã‚Œã°ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å†å…¥åŠ›ã—ãªã‘ã‚Œã°ã„ã‘ãªã„ã“ã¨ã¯ãªã„ã®ã§ä½“é¨“ãŒè‰¯ã„ã§ã™ã€‚

### amend ã‚„ merge ã§å®Ÿè¡Œã—ãªã„

ä¸Šã®ä¾‹ã§ãƒ•ãƒƒã‚¯ã‚’ç´¹ä»‹ã—ã¾ã—ãŸãŒã€ã“ã®ãƒ•ãƒƒã‚¯ã¯ amend ã®ã‚³ãƒŸãƒƒãƒˆã‚„ merge ã‚³ãƒŸãƒƒãƒˆã§ã‚‚ç™ºç«ã™ã‚‹æŒ™å‹•ã‚’ã—ã¾ã™ã€‚

ã“ã“ã¯å¥½ã¿ã§ã™ãŒã€å€‹äººçš„ã«ã¯

- amend ã¯æ—¢å­˜ã®ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¾®ä¿®æ­£ã—ãŸã‚Šã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å¤‰ãˆãªã„ã¾ã¾å·®åˆ†ã‚’è¿½åŠ ã—ãŸã‚Šã¨ã„ã†æ„Ÿã˜ã§æ”¹ã‚ã¦ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä½œã£ã¦ã»ã—ããªã„
- ãƒãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§è‰¯ã„ã®ã§ä½œã£ã¦ãã‚Œãªãã¦è‰¯ã„

ã¨æ„Ÿã˜ã‚‹ã®ã§

```bash
#!/usr/bin/env sh

# amend ã‚„ merge commit ã§ã¯ç™ºç«ã•ã›ãªã„
first_line=$(head -n1 $1)
if [ "${first_line}" != "" ]; then
  exit 0
fi

exec < /dev/tty && node_modules/.bin/cz --hook || true
```

ã“ã‚“ãªæ„Ÿã˜ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ›¸ã„ã¦ã‚ã’ã¦ç„¡åŠ¹ã«ã—ã¦ã„ã¾ã™ã€‚

## ã¾ã¨ã‚

- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¦ç´„ã‚’æ•´ãˆã‚‹ã®ã« commitlint ã‚‚è‰¯ã„ã‘ã©å¯¾è©±å‹ã§æ›¸ã‹ã›ã‚‹ã®ã‚‚ä¸€ã¤ã®é¸æŠè‚¢ã«ãªã‚Šãã†ã§ã™
  - â€» ã‚‚ã¡ã‚ã‚“ä½µç”¨ã‚‚
- è¦ç´„ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç‹¬è‡ªè¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™
- git hooks ã§ commit å‰ã« linter ç­‰å›ã—ã¦ã„ã‚‹å ´åˆã¯ cz ã§ã¯ãªã prepare-commit-msg ãƒ•ãƒƒã‚¯ã§ã¤ãªãã“ã‚€ã®ãŒã‚ªã‚¹ã‚¹ãƒ¡ã§ã™

ä»¥ä¸Šã«ãªã‚Šã¾ã™ã€‚
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼
