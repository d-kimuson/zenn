#!/usr/bin/env bash

set -eux

# è¨˜äº‹åã¨è¨˜äº‹slugã‚’å¯¾è©±å½¢å¼ã§å…¥åŠ›ã•ã›ã‚‹
read -p "è¨˜äº‹åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„: " title
read -p "è¨˜äº‹slugã‚’å…¥åŠ›ã—ã¦ãã ã•ã„: " slug

# è¨˜äº‹slugã‚’ä½¿ã£ã¦ `articles/${slug}.md` ã«markdownãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹
touch articles/${slug}.md

# frontmatter ã‚’è¨˜è¼‰ã™ã‚‹
echo "---" > articles/${slug}.md
echo "title: \"$title\"" >> articles/${slug}.md

# ãƒ©ãƒ³ãƒ€ãƒ ãªçµµæ–‡å­—ã‚’ç”Ÿæˆã™ã‚‹
emojis=("ğŸ˜€" "ğŸ˜" "ğŸ˜‚" "ğŸ¤£" "ğŸ˜ƒ" "ğŸ˜„" "ğŸ˜…" "ğŸ˜†" "ğŸ˜‰" "ğŸ˜Š" "ğŸ˜‹" "ğŸ˜" "ğŸ˜" "ğŸ˜˜" "ğŸ˜—" "ğŸ˜™" "ğŸ˜š" "ğŸ™‚" "ğŸ¤—" "ğŸ¤©" "ğŸ¤”" "ğŸ¤¨" "ğŸ˜" "ğŸ˜‘" "ğŸ˜¶" "ğŸ™„" "ğŸ˜" "ğŸ˜£" "ğŸ˜¥" "ğŸ˜®" "ğŸ¤" "ğŸ˜¯" "ğŸ˜ª" "ğŸ˜«" "ğŸ˜´" "ğŸ˜Œ" "ğŸ˜›" "ğŸ˜œ" "ğŸ˜" "ğŸ¤¤" "ğŸ˜’" "ğŸ˜“" "ğŸ˜”" "ğŸ˜•" "ğŸ™ƒ" "ğŸ¤‘" "ğŸ˜²" "â˜¹ï¸" "ğŸ™" "ğŸ˜–" "ğŸ˜" "ğŸ˜Ÿ" "ğŸ˜¤" "ğŸ˜¢" "ğŸ˜­" "ğŸ˜¦" "ğŸ˜§" "ğŸ˜¨" "ğŸ˜©" "ğŸ¤¯" "ğŸ˜¬" "ğŸ˜°" "ğŸ˜±" "ğŸ¥µ" "ğŸ¥¶" "ğŸ˜³" "ğŸ¤ª" "ğŸ˜µ" "ğŸ˜¡" "ğŸ˜ " "ğŸ¤¬" "ğŸ˜·" "ğŸ¤’" "ğŸ¤•" "ğŸ¤¢" "ğŸ¤®" "ğŸ¤§" "ğŸ˜‡" "ğŸ¤ " "ğŸ¤¡" "ğŸ¥³" "ğŸ¥´" "ğŸ¥º" "ğŸ¤¥" "ğŸ¤«" "ğŸ¤­" "ğŸ§" "ğŸ¤“" "ğŸ˜ˆ" "ğŸ‘¿" "ğŸ‘¹" "ğŸ‘º" "ğŸ’€" "ğŸ‘»" "ğŸ‘½" "ğŸ¤–" "ğŸ’©" "ğŸ˜º" "ğŸ˜¸" "ğŸ˜¹" "ğŸ˜»" "ğŸ˜¼" "ğŸ˜½" "ğŸ™€" "ğŸ˜¿" "ğŸ˜¾")
emoji=${emojis[$RANDOM % ${#emojis[@]}]}
echo "emoji: \"$emoji\"" >> articles/${slug}.md

echo "type: tech" >> articles/${slug}.md
echo "topics: []" >> articles/${slug}.md
echo "published: false" >> articles/${slug}.md
echo "---" >> articles/${slug}.md

# `articles/${slug}` ã®ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã™ã‚‹
git switch -c articles/${slug}

# æ–°è¦ä½œæˆã—ãŸãƒ–ãƒ©ãƒ³ãƒã§ã‚³ãƒŸãƒƒãƒˆã™ã‚‹
git add articles/${slug}.md
git commit -m "æ–°è¦è¨˜äº‹è¿½åŠ : ${slug}"

# push ã™ã‚‹
git push -u origin articles/${slug}

# gh cli ã‚’ä½¿ã£ã¦ Pull Request ã‚’ä½œæˆã™ã‚‹
gh pr create --title "æ–°è¦è¨˜äº‹: ${title}" --body "ã“ã® PR ã¯æ–°è¦è¨˜äº‹ ${title} ã‚’è¿½åŠ ã—ã¾ã™ã€‚" --base main --head articles/${slug} --draft
